import{a as h,R as P,b as oe,aB as le,j as t,p as _,q as $,C as de,aC as ce,av as ue,w as z,as as he,L as q,au as fe}from"./index-BKUK2GJb.js";import{a as y}from"./api-Bz9N-lAG.js";import{b as me,a as F}from"./chunk-WMSMQEIB-emWhzrVS.js";function B(){return B=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(a[n]=r[n])}return a},B.apply(null,arguments)}function ge(a,e){if(a==null)return{};var r={};for(var n in a)if({}.hasOwnProperty.call(a,n)){if(e.indexOf(n)!==-1)continue;r[n]=a[n]}return r}var xe=h.useLayoutEffect,pe=function(e){var r=P.useRef(e);return xe(function(){r.current=e}),r},D=function(e,r){if(typeof e=="function"){e(r);return}e.current=r},ve=function(e,r){var n=P.useRef();return P.useCallback(function(i){e.current=i,n.current&&D(n.current,null),n.current=r,r&&D(r,i)},[r])},G={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},be=function(e){Object.keys(G).forEach(function(r){e.style.setProperty(r,G[r],"important")})},U=be,d=null,Y=function(e,r){var n=e.scrollHeight;return r.sizingStyle.boxSizing==="border-box"?n+r.borderSize:n-r.paddingSize};function je(a,e,r,n){r===void 0&&(r=1),n===void 0&&(n=1/0),d||(d=document.createElement("textarea"),d.setAttribute("tabindex","-1"),d.setAttribute("aria-hidden","true"),U(d)),d.parentNode===null&&document.body.appendChild(d);var i=a.paddingSize,s=a.borderSize,o=a.sizingStyle,p=o.boxSizing;Object.keys(o).forEach(function(u){var c=u;d.style[c]=o[c]}),U(d),d.value=e;var l=Y(d,a);d.value=e,l=Y(d,a),d.value="x";var m=d.scrollHeight-i,g=m*r;p==="border-box"&&(g=g+i+s),l=Math.max(g,l);var f=m*n;return p==="border-box"&&(f=f+i+s),l=Math.min(f,l),[l,m]}var Q=function(){},ye=function(e,r){return e.reduce(function(n,i){return n[i]=r[i],n},{})},Ne=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Se=!!document.documentElement.currentStyle,Ce=function(e){var r=window.getComputedStyle(e);if(r===null)return null;var n=ye(Ne,r),i=n.boxSizing;if(i==="")return null;Se&&i==="border-box"&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px");var s=parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),o=parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth);return{sizingStyle:n,paddingSize:s,borderSize:o}},we=Ce;function W(a,e,r){var n=pe(r);h.useLayoutEffect(function(){var i=function(o){return n.current(o)};if(a)return a.addEventListener(e,i),function(){return a.removeEventListener(e,i)}},[])}var ze=function(e,r){W(document.body,"reset",function(n){e.current.form===n.target&&r(n)})},Re=function(e){W(window,"resize",e)},Le=function(e){W(document.fonts,"loadingdone",e)},He=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Ee=function(e,r){var n=e.cacheMeasurements,i=e.maxRows,s=e.minRows,o=e.onChange,p=o===void 0?Q:o,l=e.onHeightChange,m=l===void 0?Q:l,g=ge(e,He),f=g.value!==void 0,u=h.useRef(null),c=ve(u,r),R=h.useRef(0),N=h.useRef(),v=function(){var x=u.current,C=n&&N.current?N.current:we(x);if(C){N.current=C;var b=je(C,x.value||x.placeholder||"x",s,i),j=b[0],H=b[1];R.current!==j&&(R.current=j,x.style.setProperty("height",j+"px","important"),m(j,{rowHeight:H}))}},L=function(x){f||v(),p(x)};return h.useLayoutEffect(v),ze(u,function(){if(!f){var S=u.current.value;requestAnimationFrame(function(){var x=u.current;x&&S!==x.value&&v()})}}),Re(v),Le(v),h.createElement("textarea",B({},g,{onChange:L,ref:c}))},Ie=h.forwardRef(Ee),X=oe(({style:a,minRows:e=3,maxRows:r=8,cacheMeasurements:n=!1,disableAutosize:i=!1,onHeightChange:s,...o},p)=>{const{Component:l,label:m,description:g,startContent:f,endContent:u,hasHelper:c,shouldLabelBeOutside:R,shouldLabelBeInside:N,isInvalid:v,errorMessage:L,getBaseProps:S,getLabelProps:x,getInputProps:C,getInnerWrapperProps:b,getInputWrapperProps:j,getHelperWrapperProps:H,getDescriptionProps:Z,getErrorMessageProps:J,isClearable:T,getClearButtonProps:A}=le({...o,ref:p,isMultiline:!0}),[K,V]=h.useState(e>1),[ee,te]=h.useState(!1),M=m?t.jsx("label",{...x(),children:m}):null,w=C(),re=(E,I)=>{if(e===1&&V(E>=I.rowHeight*2),r>e){const se=E>=r*I.rowHeight;te(se)}s==null||s(E,I)},O=i?t.jsx("textarea",{...w,style:_(w.style,a??{})}):t.jsx(Ie,{...w,cacheMeasurements:n,"data-hide-scroll":$(!ee),maxRows:r,minRows:e,style:_(w.style,a??{}),onHeightChange:re}),ne=h.useMemo(()=>T?t.jsx("button",{...A(),children:t.jsx(de,{})}):null,[T,A]),ae=h.useMemo(()=>f||u?t.jsxs("div",{...b(),children:[f,O,u]}):t.jsx("div",{...b(),children:O}),[f,w,u,b]),k=v&&L,ie=k||g;return t.jsxs(l,{...S(),children:[R?M:null,t.jsxs("div",{...j(),"data-has-multiple-rows":$(K),children:[N?M:null,ae,ne]}),c&&ie?t.jsx("div",{...H(),children:k?t.jsx("div",{...J(),children:L}):t.jsx("div",{...Z(),children:g})}):null]})});X.displayName="HeroUI.Textarea";var Fe=X;const Pe=({note:a})=>t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4 border border-gray-200",children:[t.jsx("div",{className:"text-gray-800 mb-3 whitespace-pre-wrap",children:a.content}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("div",{className:"text-gray-500",children:a.createdAt}),t.jsx("div",{className:"flex items-center",children:t.jsx("span",{className:"text-gray-700 font-medium",children:a.createdBy})})]})]}),Ae=function(){const{orgId:e,contactId:r}=ce.useParams(),n=ue(),i=z(y.organizations.getOrganizationById,{id:e}),s=z(y.contacts.getContactById,{id:r}),o=z(y.notes.getNotesByContactId,{contactId:r}),p=he(y.notes.createNote),[l,m]=h.useState(""),g=z(y.auth.hasRole,{orgId:e,role:"admin"}),f=z(y.auth.hasRole,{orgId:e,role:"member"});g==!1&&f==!1&&n({to:"/"});const u=async()=>{if(l)try{await p({contactId:r,content:l}),m("")}catch{console.error("Failed to create note");return}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"lg:flex lg:items-center lg:justify-between",children:t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs(me,{size:"lg",children:[t.jsx(F,{children:t.jsx(q,{to:"/",children:"Home"})}),t.jsx(F,{children:t.jsx(q,{to:"/orgs/$orgId",params:{orgId:e},children:"Organization"})}),t.jsx(F,{children:"Contact"})]},"lg"),t.jsx("h2",{className:"text-2xl/7 font-bold text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight",children:i==null?void 0:i.name})]})}),t.jsxs("div",{className:"flex bg-white shadow-md rounded-lg p-4 mt-5 h-3/5",style:{height:"80vh"},children:[t.jsxs("div",{className:"flex-col mb-4 w-1/2",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Contact Details"}),t.jsxs("div",{className:"flex ml-4 mt-4",children:[t.jsx("div",{className:"flex-1",children:"Name:"}),t.jsxs("div",{className:"flex-1 ml-2",children:[s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]})]}),t.jsxs("div",{className:"flex ml-4 mt-4",children:[t.jsx("div",{className:"flex-1",children:"Email:"}),t.jsx("div",{className:"flex-1 ml-2",children:s==null?void 0:s.email})]}),t.jsxs("div",{className:"flex ml-4 mt-4",children:[t.jsx("div",{className:"flex-1",children:"Phone:"}),t.jsx("div",{className:"flex-1 ml-2",children:s==null?void 0:s.phone})]})]}),t.jsxs("div",{className:"flex-col mb-4 w-1/2 ml-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Notes"}),t.jsx("div",{className:"flex-col  mt-4 overflow-y-auto",style:{height:"50vh"},children:o&&o.length>0&&o.map(c=>t.jsx(Pe,{note:{content:c.content,createdAt:c.createdAt,createdBy:c.createdBy}},c.id))}),t.jsxs("div",{className:"mt-4",children:[t.jsx(Fe,{className:"max-w",label:"Write a note for this contact",placeholder:"Enter your note",maxRows:2,onChange:c=>m(c.target.value),value:l}),t.jsx(fe,{className:"mt-2 float-right",color:"primary",onPress:()=>u(),children:"Add Note"})]})]})]})]})};export{Ae as component};
